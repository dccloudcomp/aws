{"filter":false,"title":"frontend.tf","tooltip":"/terraform/frontend.tf","undoManager":{"mark":3,"position":3,"stack":[[{"start":{"row":32,"column":2},"end":{"row":32,"column":50},"action":"remove","lines":["depends_on   = [aws_cloudfront_distribution.cdn]"],"id":5}],[{"start":{"row":28,"column":6},"end":{"row":28,"column":68},"action":"remove","lines":["website_endpoint = aws_cloudfront_distribution.cdn.domain_name"],"id":6}],[{"start":{"row":28,"column":6},"end":{"row":28,"column":64},"action":"insert","lines":["website_endpoint = aws_s3_bucket.frontend.website_endpoint"],"id":7}],[{"start":{"row":0,"column":0},"end":{"row":2,"column":3},"action":"remove","lines":["locals {","  frontend_dir   = \"${path.module}/../frontend\"","  f"],"id":8,"ignore":true},{"start":{"row":0,"column":0},"end":{"row":5,"column":8},"action":"insert","lines":["resource \"aws_s3_bucket\" \"frontend\" {","  bucket = var.frontend_bucket_name","","  tags = {","    Name        = \"Frontend Dashboard\"","    Envi"]},{"start":{"row":5,"column":11},"end":{"row":5,"column":12},"action":"remove","lines":["t"]},{"start":{"row":5,"column":11},"end":{"row":5,"column":12},"action":"insert","lines":["m"]},{"start":{"row":5,"column":14},"end":{"row":7,"column":60},"action":"remove","lines":["d_files = {","    \"index.html\" = { path = \"${local.frontend_dir}/index.html\", content_type = \"text/html\" }","    \"script.js\"  = { path = \"${local.frontend_dir}/script.js"]},{"start":{"row":5,"column":14},"end":{"row":26,"column":25},"action":"insert","lines":["t = \"Dev\"","  }","}","","resource \"aws_s3_bucket_website_configuration\" \"frontend\" {","  bucket = aws_s3_bucket.frontend.id","","  index_document {","    suffix = \"index.html\"","  }","","  error_document {","    key = \"error.html\"","  }","}","","# Permitir acceso público al sitio web","resource \"aws_s3_bucket_policy\" \"frontend_policy\" {","  bucket = aws_s3_bucket.frontend.id","","  policy = jsonencode({","    Version = \"2012-10-17"]},{"start":{"row":26,"column":27},"end":{"row":27,"column":0},"action":"insert","lines":["",""]},{"start":{"row":27,"column":2},"end":{"row":31,"column":0},"action":"remove","lines":["content_type = \"application/javascript\" }","    \"style.css\"  = { path = \"${local.frontend_dir}/style.css\",  content_type = \"text/css\" }","  }","}",""]},{"start":{"row":27,"column":2},"end":{"row":39,"column":40},"action":"insert","lines":["  Statement = [","      {","        Sid       = \"PublicReadGetObject\",","        Effect    = \"Allow\",","        Principal = \"*\",","        Action    = \"s3:GetObject\",","        Resource  = \"${aws_s3_bucket.frontend.arn}/*\"","      }","    ]","  })","}","","# Subir archivos estáticos del dashboard"]},{"start":{"row":40,"column":35},"end":{"row":40,"column":41},"action":"remove","lines":["static"]},{"start":{"row":40,"column":35},"end":{"row":40,"column":40},"action":"insert","lines":["files"]},{"start":{"row":41,"column":17},"end":{"row":41,"column":37},"action":"remove","lines":["local.frontend_files"]},{"start":{"row":41,"column":17},"end":{"row":41,"column":64},"action":"insert","lines":["fileset(\"${path.module}/../frontend\", \"**/*.*\")"]},{"start":{"row":42,"column":31},"end":{"row":42,"column":38},"action":"remove","lines":["website"]},{"start":{"row":42,"column":31},"end":{"row":42,"column":39},"action":"insert","lines":["frontend"]},{"start":{"row":43,"column":22},"end":{"row":43,"column":25},"action":"remove","lines":["key"]},{"start":{"row":43,"column":22},"end":{"row":43,"column":27},"action":"insert","lines":["value"]},{"start":{"row":44,"column":17},"end":{"row":44,"column":47},"action":"insert","lines":["\"${path.module}/../frontend/${"]},{"start":{"row":44,"column":57},"end":{"row":44,"column":62},"action":"remove","lines":[".path"]},{"start":{"row":44,"column":57},"end":{"row":44,"column":59},"action":"insert","lines":["}\""]},{"start":{"row":45,"column":25},"end":{"row":46,"column":17},"action":"remove","lines":["each.value.path)","  content_type = "]},{"start":{"row":45,"column":25},"end":{"row":45,"column":55},"action":"insert","lines":["\"${path.module}/../frontend/${"]},{"start":{"row":45,"column":65},"end":{"row":45,"column":66},"action":"remove","lines":["."]},{"start":{"row":45,"column":65},"end":{"row":46,"column":2},"action":"insert","lines":["}\")","  "]},{"start":{"row":46,"column":14},"end":{"row":63,"column":2},"action":"remove","lines":["","  depends_on   = [aws_s3_bucket_website_configuration.website]","}","","resource \"aws_s3_object\" \"frontend_config\" {","  bucket = aws_s3_bucket.website.id","  key    = \"config.js\"","  content = templatefile(","    \"${local.frontend_dir}/config.template.js\",","    {","      website_bucket   = aws_s3_bucket.website.bucket","      results_prefix   = var.results_prefix","      # Usamos el dominio de CloudFront como endpoint público","      website_endpoint = aws_s3_bucket.frontend.website_endpoint","    }","  )","  content_type = \"application/javascript\"","  "]},{"start":{"row":46,"column":14},"end":{"row":59,"column":71},"action":"insert","lines":[" = lookup(","    {","      html = \"text/html\",","      css  = \"text/css\",","      js   = \"application/javascript\",","      json = \"application/json\"","    },","    split(\".\", each.value)[length(split(\".\", each.value)) - 1],","    \"application/octet-stream\"","  )","}","","output \"frontend_website_url\" {","  value = aws_s3_bucket_website_configuration.frontend.website_endpoint"]}]]},"ace":{"folds":[],"scrolltop":327.2727083568741,"scrollleft":0,"selection":{"start":{"row":38,"column":0},"end":{"row":38,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1754750596001,"hash":"7fe1fa81588db365c5e3bfe41718d1be930b643f"}